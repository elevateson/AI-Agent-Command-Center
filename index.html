<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self'; connect-src 'none'; frame-ancestors 'none';">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta name="referrer" content="no-referrer">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0f0f1a">
  <title>Command Center</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <div class="header-left">
      <h1>ğŸ¯ Command Center</h1>
      <div class="subtitle">AI Agent Task Management</div>
    </div>
    <div class="header-center">
      <div class="search-wrapper" id="search-wrapper">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="global-search" placeholder="Search tasks, projects... (âŒ˜K)" autocomplete="off">
        <span class="search-shortcut">âŒ˜K</span>
        <div class="search-results" id="search-results"></div>
      </div>
    </div>
    <div class="header-right">
      <div class="notif-wrapper" id="notif-wrapper">
        <button class="notif-bell-btn" id="notif-bell" title="Notifications">ğŸ””<span class="notif-badge" id="notif-badge" style="display:none;">0</span></button>
        <div class="notif-panel" id="notif-panel" style="display:none;">
          <div class="notif-header">
            <strong>Notifications</strong>
            <button id="notif-mark-all" class="notif-mark-all">Mark all read</button>
          </div>
          <div class="notif-list" id="notif-list"></div>
        </div>
      </div>
      <button class="theme-toggle-btn" id="theme-toggle" title="Toggle theme">ğŸŒ™</button>
    </div>
    <div class="tabs">
      <button class="tab-btn active" data-tab="dashboard">ğŸ  Dashboard</button>
      <button class="tab-btn" data-tab="board">ğŸ“‹ Board</button>
      <button class="tab-btn" data-tab="projects">ğŸ“ Projects</button>
      <button class="tab-btn" data-tab="calendar">ğŸ“… Calendar</button>
      <button class="tab-btn" data-tab="settings">âš™ï¸ Settings</button>
    </div>
  </div>

  <!-- CONTENT -->
  <div class="content">
    <div id="dashboard-tab" class="tab-content active"></div>
    <div id="board-tab" class="tab-content"></div>
    <div id="projects-tab" class="tab-content"></div>
    <div id="calendar-tab" class="tab-content"></div>
    <div id="settings-tab" class="tab-content"></div>
  </div>

  <!-- MOBILE BOTTOM NAV -->
  <div class="mobile-nav">
    <div class="mobile-nav-inner">
      <button class="mobile-nav-btn active" data-tab="dashboard">
        <span class="nav-icon">ğŸ </span>
        <span>Home</span>
      </button>
      <button class="mobile-nav-btn" data-tab="board">
        <span class="nav-icon">ğŸ“‹</span>
        <span>Board</span>
      </button>
      <button class="mobile-nav-btn" data-tab="projects">
        <span class="nav-icon">ğŸ“</span>
        <span>Projects</span>
      </button>
      <button class="mobile-nav-btn" data-tab="calendar">
        <span class="nav-icon">ğŸ“…</span>
        <span>Calendar</span>
      </button>
      <button class="mobile-nav-btn" data-tab="settings">
        <span class="nav-icon">âš™ï¸</span>
        <span>Settings</span>
      </button>
    </div>
  </div>

  <!-- TASK MODAL (Edit/Create) -->
  <div id="task-modal" class="modal">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h2 id="modal-title">New Task</h2>
        <button class="modal-close" data-close="task-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-tabs">
          <button class="modal-tab-btn active" data-modal-tab="details">Details</button>
          <button class="modal-tab-btn" data-modal-tab="subtasks">Subtasks</button>
          <button class="modal-tab-btn" data-modal-tab="comments">Comments</button>
          <button class="modal-tab-btn" data-modal-tab="links">Links</button>
          <button class="modal-tab-btn" data-modal-tab="dependencies">Dependencies</button>
          <button class="modal-tab-btn" data-modal-tab="activity">Activity</button>
        </div>

        <!-- Details Tab -->
        <div class="modal-tab-content active" data-modal-panel="details">
          <div class="form-group">
            <label>Title</label>
            <input type="text" id="task-title" placeholder="Task title...">
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea id="task-desc" placeholder="Task description..."></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Status</label>
              <select id="task-status">
                <option value="blocked">ğŸ”´ Blocked</option>
                <option value="todo" selected>ğŸŸ¡ To-Do</option>
                <option value="onhold">â¸ï¸ On Hold</option>
                <option value="in-progress">ğŸ”µ In Progress</option>
                <option value="done">âœ… Done</option>
              </select>
            </div>
            <div class="form-group">
              <label>Priority</label>
              <select id="task-priority">
                <option value="critical">ğŸ”´ Critical</option>
                <option value="high">ğŸŸ  High</option>
                <option value="medium" selected>ğŸŸ¡ Medium</option>
                <option value="low">ğŸŸ¢ Low</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Assignee</label>
              <select id="task-assignee">
                <option value="">â€” Unassigned â€”</option>
                <option value="kris">ğŸ§‘â€ğŸ’¼ Kris</option>
                <option value="taylor">ğŸ¦‰ Taylor</option>
                <option value="nyx">ğŸ¤– Nyx</option>
              </select>
            </div>
            <div class="form-group">
              <label>Project</label>
              <select id="task-project">
                <option value="">â€” No Project â€”</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Tags (comma-separated)</label>
            <input type="text" id="task-tags" placeholder="e.g. coding, design, urgent">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Due Date</label>
              <input type="date" id="task-due-date">
            </div>
            <div class="form-group">
              <label>AI Model</label>
              <input type="text" id="task-model" placeholder="e.g. opus, sonnet">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Estimated Cost ($)</label>
              <input type="number" id="task-est-cost" placeholder="0.00" step="0.01">
            </div>
            <div class="form-group">
              <label>Actual Cost ($)</label>
              <input type="number" id="task-act-cost" placeholder="0.00" step="0.01">
            </div>
          </div>
          <div class="form-group">
            <label>Progress: <span id="task-progress-val">0%</span></label>
            <input type="range" id="task-progress" min="0" max="100" value="0">
          </div>
        </div>

        <!-- Subtasks Tab -->
        <div class="modal-tab-content" data-modal-panel="subtasks">
          <div class="subtask-add-row">
            <input type="text" id="subtask-input" placeholder="Add subtask...">
            <button class="btn btn-primary btn-sm" id="subtask-add-btn">+ Add</button>
          </div>
          <div id="subtask-list" class="subtask-list"></div>
        </div>

        <!-- Comments Tab -->
        <div class="modal-tab-content" data-modal-panel="comments">
          <div id="comments-list" class="comments-list"></div>
          <div class="comment-add-row">
            <select id="comment-author" class="comment-author-select">
              <option value="kris">ğŸ§‘â€ğŸ’¼ Kris</option>
              <option value="taylor">ğŸ¦‰ Taylor</option>
              <option value="nyx">ğŸ¤– Nyx</option>
              <option value="system">âš™ï¸ System</option>
            </select>
            <input type="text" id="comment-input" placeholder="Add a comment...">
            <button class="btn btn-primary btn-sm" id="comment-add-btn">Send</button>
          </div>
        </div>

        <!-- Links Tab -->
        <div class="modal-tab-content" data-modal-panel="links">
          <div class="link-add-row">
            <input type="text" id="link-label" placeholder="Label...">
            <input type="url" id="link-url" placeholder="https://...">
            <button class="btn btn-primary btn-sm" id="link-add-btn">+ Add</button>
          </div>
          <div id="links-list" class="links-list"></div>
        </div>

        <!-- Dependencies Tab -->
        <div class="modal-tab-content" data-modal-panel="dependencies">
          <div class="form-group">
            <label>Blocked By (select tasks that must finish first)</label>
            <div id="dependency-list" class="dependency-list"></div>
          </div>
          <div class="form-group">
            <label>Add Blocker</label>
            <select id="dependency-select">
              <option value="">â€” Select a task â€”</option>
            </select>
            <button class="btn btn-secondary btn-sm" id="dependency-add-btn" style="margin-top:8px">+ Add Blocker</button>
          </div>
        </div>

        <!-- Activity Tab -->
        <div class="modal-tab-content" data-modal-panel="activity">
          <div id="task-activity-list" class="task-activity-list"></div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="modal-footer-left">
          <button class="btn btn-danger" id="task-delete-btn" style="display:none">ğŸ—‘ï¸ Delete</button>
        </div>
        <div class="modal-footer-right">
          <button class="btn btn-secondary" data-close="task-modal">Cancel</button>
          <button class="btn btn-primary" id="task-save-btn">ğŸ’¾ Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- PROJECT MODAL -->
  <div id="project-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="proj-modal-title">New Project</h2>
        <button class="modal-close" data-close="project-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Project Name</label>
          <input type="text" id="proj-name" placeholder="Project name...">
        </div>
        <div class="form-group">
          <label>Description</label>
          <textarea id="proj-desc" placeholder="What is this project about?"></textarea>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Status</label>
            <select id="proj-status">
              <option value="planning">Planning</option>
              <option value="active">Active</option>
              <option value="on-hold">On Hold</option>
              <option value="completed">Completed</option>
              <option value="archived">Archived</option>
            </select>
          </div>
          <div class="form-group">
            <label>Priority</label>
            <select id="proj-priority">
              <option value="critical">ğŸ”´ Critical</option>
              <option value="high">ğŸŸ  High</option>
              <option value="medium" selected>ğŸŸ¡ Medium</option>
              <option value="low">ğŸŸ¢ Low</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>Color</label>
          <div class="color-picker-grid" id="proj-color-grid"></div>
          <input type="hidden" id="proj-color" value="#2196f3">
        </div>
        <div class="form-group">
          <label>Team Members</label>
          <div class="checkbox-group">
            <label><input type="checkbox" class="proj-assignee-cb" value="kris"> ğŸ§‘â€ğŸ’¼ Kris</label>
            <label><input type="checkbox" class="proj-assignee-cb" value="taylor"> ğŸ¦‰ Taylor</label>
            <label><input type="checkbox" class="proj-assignee-cb" value="nyx"> ğŸ¤– Nyx</label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="modal-footer-left">
          <button class="btn btn-danger" id="proj-delete-btn" style="display:none">ğŸ—‘ï¸ Delete</button>
        </div>
        <div class="modal-footer-right">
          <button class="btn btn-secondary" data-close="project-modal">Cancel</button>
          <button class="btn btn-primary" id="proj-save-btn">ğŸ’¾ Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- QUICK ADD MODAL -->
  <div id="quick-add-modal" class="modal">
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h2>âš¡ Quick Add Task</h2>
        <button class="modal-close" data-close="quick-add-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Title</label>
          <input type="text" id="qa-title" placeholder="Task title..." autofocus>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Project</label>
            <select id="qa-project"><option value="">â€” None â€”</option></select>
          </div>
          <div class="form-group">
            <label>Assignee</label>
            <select id="qa-assignee">
              <option value="">Unassigned</option>
              <option value="kris">ğŸ§‘â€ğŸ’¼ Kris</option>
              <option value="taylor">ğŸ¦‰ Taylor</option>
              <option value="nyx">ğŸ¤– Nyx</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Priority</label>
            <select id="qa-priority">
              <option value="critical">ğŸ”´ Critical</option>
              <option value="high">ğŸŸ  High</option>
              <option value="medium" selected>ğŸŸ¡ Medium</option>
              <option value="low">ğŸŸ¢ Low</option>
            </select>
          </div>
          <div class="form-group">
            <label>Status</label>
            <select id="qa-status">
              <option value="todo" selected>ğŸŸ¡ To-Do</option>
              <option value="in-progress">ğŸ”µ In Progress</option>
              <option value="blocked">ğŸ”´ Blocked</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>From Template</label>
          <select id="qa-template">
            <option value="">â€” No Template â€”</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <div class="modal-footer-left"></div>
        <div class="modal-footer-right">
          <button class="btn btn-secondary" data-close="quick-add-modal">Cancel</button>
          <button class="btn btn-primary" id="qa-save-btn">âš¡ Create</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TASK DETAIL MODAL (read-only quick view) -->
  <div id="task-detail-modal" class="modal">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h2 id="detail-modal-title">Task Detail</h2>
        <button class="modal-close" data-close="task-detail-modal">&times;</button>
      </div>
      <div class="modal-body" id="task-detail-body"></div>
      <div class="modal-footer">
        <div class="modal-footer-left">
          <button class="btn btn-secondary" id="detail-edit-btn">âœï¸ Edit</button>
        </div>
        <div class="modal-footer-right">
          <button class="btn btn-secondary" data-close="task-detail-modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TOAST CONTAINER -->
  <div id="toast-container"></div>

  <!-- SCRIPTS (order matters: utils â†’ datastore â†’ views â†’ app) -->
  <script src="js/utils.js"></script>
  <script src="js/datastore.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/board.js"></script>
  <script src="js/projects.js"></script>
  <script src="js/calendar.js"></script>
  <script src="js/settings.js"></script>
  <script src="js/app.js"></script>

</body>
</html>
